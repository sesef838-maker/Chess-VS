<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุชุทุจูู ุดุทุฑูุฌ ุงุญุชุฑุงูู | ุซูุงุซ ูุงุฌูุงุช</title>
    
    <link rel="stylesheet" href="styles.css">
    
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
</head>
<body>

    <header>
        <h1> ุชุทุจูู ุดุทุฑูุฌ ุงุญุชุฑุงูู ๐ </h1>
        <div id="header-buttons">
            <button id="lobby-button" style="display:none;">ูุงุฆูุฉ ุงููุงุนุจูู</button>
            <button id="settings-button" aria-label="ุงูุฅุนุฏุงุฏุงุช">โ๏ธ</button>
            <button id="logout-button" class="btn-error" style="display:none;">ุฎุฑูุฌ</button>
        </div>
    </header>

    <div class="main-content-area">
        
        <section id="login-view" class="view active-view">
            <div class="auth-box">
                <h2>ุชุณุฌูู ุงูุฏุฎูู / ุฅูุดุงุก ุญุณุงุจ ุขูู</h2>
                <div id="auth-area">
                    </div>
            </div>
        </section>

        <section id="lobby-view" class="view" style="display:none;">
            <aside class="lobby-sidebar">
                <div class="user-stats-card">
                    <h3>ุฃูุช: <span id="user-display-email"></span></h3>
                    <p>ุงูุชูููู (ELO): <span id="user-rating">1200</span></p>
                    <p>ุถุจุท ุงูุชุญุฏู:</p>
                    <select id="time-control-select" class="full-width-select">
                        <option value="5">5 ุฏูุงุฆู (ุณุฑูุน)</option>
                        <option value="10">10 ุฏูุงุฆู (ุฎุงุทู)</option>
                        <option value="15">15 ุฏูููุฉ</option>
                        <option value="40">40 ุฏูููุฉ (ููุงุณููู)</option>
                    </select>
                    <select id="match-type-select" class="full-width-select">
                        <option value="rated">ูุจุงุฑุงุฉ ูุตููุฉ</option>
                        <option value="unrated">ูุจุงุฑุงุฉ ุบูุฑ ูุตููุฉ</option>
                    </select>
                </div>
                
                <div class="control-group">
                    <input type="text" id="search-input" placeholder="ุจุญุซ ุนู ูุงุนุจ ุจุฑูุฏ ุฅููุชุฑููู/ูุนุฑู...">
                    <button id="search-button">ุจุญุซ</button>
                </div>
            </aside>
            
            <main class="lobby-main">
                <h2>ุงููุงุนุจูู ุงููุดุทูู (๐ข) ูุงูุชุญุฏูุงุช ุงููุงุฑุฏุฉ</h2>
                <ul id="active-players-list" class="player-list"></ul>
                
                <h3 class="list-title inactive-title">ุงููุงุนุจูู ุงูุขุฎุฑูู (โซ)</h3>
                <ul id="inactive-players-list" class="player-list"></ul>
            </main>
        </section>
        
        <section id="game-view" class="view" style="display:none;">
            <main class="game-board-area">
                <div id="chessboard" class="chessboard"></div>
            </main>
            
            <div class="game-info-sidebar">
                <h3 id="opponent-name">ุงูุฎุตู: ุฌุงุฑู ุงูุชุญููู...</h3>
                <p>ููุช ุงููุจุงุฑุงุฉ: <span id="game-time-control">N/A</span></p>
                <div id="player-clocks">
                    <div id="white-clock" class="clock">ุฃุจูุถ: 00:00</div>
                    <div id="black-clock" class="clock">ุฃุณูุฏ: 00:00</div>
                </div>
                <div id="game-status-message" class="status-message">ุงูุชุธุฑ ุญุฑูุฉ ุงูุฎุตู...</div>
                <button id="resign-button" class="btn-error">ุงุณุชุณูุงู</button>
                <button id="draw-button">ุทูุจ ุชุนุงุฏู</button>
            </div>
        </section>

    </div>

    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2>ุฅุนุฏุงุฏุงุช ุงููููุน</h2>
            <div id="settings-content">
                <label for="theme-select">ุงุฎุชูุงุฑ ุงููุธูุฑ:</label>
                <select id="theme-select">
                    <option value="dark">ูุธูู (Dark)</option>
                    <option value="light">ูุงุชุญ (Light)</option>
                </select>
                <p class="security-note">ุชูุจูู: ุชุทุจููู ูุญูู ุจููุงุนุฏ ุฃูุงู ุตุงุฑูุฉ ููุคูู ุนุจุฑ Firebase.</p>
            </div>
        </div>
    </div>


    <script>
        // *** 1. ุชูููู Firebase (ุจุงุณุชุฎุฏุงู ุจูุงูุงุชู) ***
        const firebaseConfig = {
            apiKey: "AIzaSyA8YheQlUP4BaWpa1iTE1MjTjttS1B6_rU",
            authDomain: "chat-app-965ed.firebaseapp.com",
            databaseURL: "https://chat-app-965ed-default-rtdb.firebaseio.com",
            projectId: "chat-app-965ed",
            storageBucket: "chat-app-965ed.firebasestorage.app",
            messagingSenderId: "263991499805",
            appId: "1:263991499805:web:60f6900f7ed6d30520baf4",
        };

        // ุงูุชููุฆุฉ ุงูุนุงูุฉ
        const app = firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.database();
        let currentUserId = null;
        let currentGameId = null; 

        // ุฏุงูุฉ ุงูุชุจุฏูู ุจูู ุงููุดุงูุฏ (ุงููุงุฌูุงุช)
        window.switchView = function(viewId) {
            document.querySelectorAll('.view').forEach(view => {
                view.style.display = 'none';
                view.classList.remove('active-view');
            });
            const targetView = document.getElementById(viewId);
            if (targetView) {
                targetView.style.display = 'flex';
                targetView.classList.add('active-view');
                window.scrollTo(0, 0);
            }
        };

        // ุฏุงูุฉ ุชุทููุฑ ุงููุฏุฎูุงุช (ููุฃูุงู)
        window.sanitizeInput = function(input) {
            const temp = document.createElement('div');
            temp.textContent = input;
            return temp.innerHTML;
        }
    </script>
    
    <script src="auth.js"></script>
    <script src="game.js"></script>
    <script src="app.js"></script>
</body>
</html>