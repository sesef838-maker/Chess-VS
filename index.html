<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุชุทุจูู ุดุทุฑูุฌ ุงุญุชุฑุงูู | ุงููุณุฎุฉ ุงููุทูุฑุฉ</title>
    
    <link rel="stylesheet" href="styles.css">
    
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"></script>

</head>
<body>

    <header>
        <h1 class="logo"> Professional Chess ๐ </h1>
        <div id="header-buttons">
            <button id="lobby-button" style="display:none;">ุงูุฑุฏูุฉ</button>
            <button id="settings-button" aria-label="ุงูุฅุนุฏุงุฏุงุช">โ๏ธ</button>
            <button id="logout-button" class="btn-error" style="display:none;">ุฎุฑูุฌ</button>
        </div>
    </header>

    <div class="main-container">
        
        <section id="login-view" class="view">
            <div class="auth-box">
                <h2>ุชุณุฌูู ุงูุฏุฎูู / ุฅูุดุงุก ุญุณุงุจ</h2>
                <div id="auth-area">
                    </div>
                <p id="auth-error-message" class="error-text"></p>
            </div>
        </section>

        <section id="lobby-view" class="view">
            <aside class="sidebar">
                <div class="card">
                    <h3>๐ค ูููู ุงูุดุฎุตู</h3>
                    <p>ูุฑุญุจุงู, <strong id="user-display-name"></strong></p>
                    <p>ุงูุชูููู (ELO): <span id="user-rating">1200</span></p>
                </div>
                <div class="card">
                    <h3>โ๏ธ ุฅุนุฏุงุฏุงุช ุงูุชุญุฏู</h3>
                    <label for="time-control-select">ููุช ุงููุจุงุฑุงุฉ:</label>
                    <select id="time-control-select" class="control-input">
                        <option value="5">5 ุฏูุงุฆู (Blitz)</option>
                        <option value="10">10 ุฏูุงุฆู (Rapid)</option>
                        <option value="30">30 ุฏูููุฉ (Classical)</option>
                    </select>
                    <label for="match-type-select">ููุน ุงููุจุงุฑุงุฉ:</label>
                    <select id="match-type-select" class="control-input">
                        <option value="rated">ูุตููุฉ (Rated)</option>
                        <option value="unrated">ูุฏูุฉ (Unrated)</option>
                    </select>
                </div>
            </aside>
            
            <main class="main-content">
                <h2>ุงููุงุนุจูู ุงููุชููุฑูู</h2>
                <div class="player-lists-container">
                    <div class="player-list-wrapper">
                        <h3>๐ข ูุชุตููู</h3>
                        <ul id="active-players-list" class="player-list"></ul>
                    </div>
                    <div class="player-list-wrapper">
                        <h3>โซ ุบูุฑ ูุชุตููู</h3>
                        <ul id="inactive-players-list" class="player-list"></ul>
                    </div>
                </div>
            </main>
        </section>
        
        <section id="game-view" class="view">
            <div class="game-info-panel top-panel">
                 <div class="player-info">
                    <span id="opponent-name">ุงูุฎุตู</span>
                    <span class="clock" id="opponent-clock">00:00</span>
                </div>
            </div>

            <main class="game-board-area">
                <div id="chessboard" class="chessboard"></div>
            </main>
            
            <div class="game-info-panel bottom-panel">
                 <div class="player-info">
                    <span id="player-name">ุฃูุช</span>
                    <span class="clock" id="player-clock">00:00</span>
                </div>
                 <div id="game-controls">
                    <button id="draw-button">ุทูุจ ุชุนุงุฏู</button>
                    <button id="resign-button" class="btn-error">ุงุณุชุณูุงู</button>
                </div>
            </div>
            <div id="game-status-message" class="status-message"></div>
        </section>

    </div>

    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2>ุงูุฅุนุฏุงุฏุงุช</h2>
            <div class="settings-form">
                <label for="theme-select">ูุธูุฑ ุงููููุน:</label>
                <select id="theme-select" class="control-input">
                    <option value="dark">ุฏุงูู (Dark)</option>
                    <option value="light">ูุงุชุญ (Light)</option>
                </select>
            </div>
        </div>
    </div>

    <div id="challenge-modal" class="modal">
        <div class="modal-content">
            <h3>โ๏ธ ุชุญุฏู ุฌุฏูุฏ ูุฑุฏ ุฅููู! โ๏ธ</h3>
            <p id="challenge-details"></p>
            <div class="modal-actions">
                <button id="accept-challenge-btn" class="btn-primary">ูุจูู</button>
                <button id="decline-challenge-btn" class="btn-secondary">ุฑูุถ</button>
            </div>
        </div>
    </div>

    <script>
        // *** 1. ุชูููู Firebase (ุงุณุชุฎุฏู ุจูุงูุงุชู ุงูุฎุงุตุฉ ููุง) ***
        const firebaseConfig = {
            apiKey: "AIzaSyA8YheQlUP4BaWpa1iTE1MjTjttS1B6_rU",
            authDomain: "chat-app-965ed.firebaseapp.com",
            databaseURL: "https://chat-app-965ed-default-rtdb.firebaseio.com",
            projectId: "chat-app-965ed",
            storageBucket: "chat-app-965ed.firebasestorage.app",
            messagingSenderId: "263991499805",
            appId: "1:263991499805:web:60f6900f7ed6d30520baf4",
        };

        // ุงูุชููุฆุฉ ุงูุนุงูุฉ
        const app = firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.database();
        let currentUserId = null;
        let currentGameId = null; 

        // ุฏุงูุฉ ุงูุชุจุฏูู ุจูู ุงููุงุฌูุงุช
        window.switchView = function(viewId) {
            document.querySelectorAll('.view').forEach(view => view.style.display = 'none');
            const targetView = document.getElementById(viewId);
            if (targetView) targetView.style.display = 'flex';
        };

        // ุฏุงูุฉ ุชุทููุฑ ุงููุฏุฎูุงุช ููุฃูุงู
        window.sanitizeInput = (input) => {
            const temp = document.createElement('div');
            temp.textContent = input;
            return temp.innerHTML;
        };
    </script>
    
    <script src="auth.js"></script>
    <script src="app.js"></script>
    <script src="game.js"></script>
</body>
</html>